<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/html">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
	<title>全真影院-购票选座</title>
	<!--设置网页图标-->
	<link rel="shortcut icon" href="images/logo.ico" type=”image/x-icon” />
	<!-- Bootstrap -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/header.css" rel="stylesheet">
	<link href="css/footer.css" rel="stylesheet">
	<link href="css/jquery.seat-charts.css" rel="stylesheet">
</head>

<body>
<!--这是页头-->
<div class="header">
	<div class="container">
		<a href="index.html">
			<span><img src="images/logo.png"> </span>
		</a>
	</div>
</div>

<div class="panel-group" id="accordion">
	<div class="panel panel-default">
		<div class="panel-heading">
			<h4 class="panel-title">
				<a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">电影购票</a>
			</h4>
		</div>
		<div id="collapseOne" class="panel-collapse collapse in">
			<div class="panel-body">
				<div id="main">
					<div class="demo">
						<div id="seat-map">
							<div class="front">屏幕</div>
						</div>
						<div class="booking-details center">
							<p>影片：大鱼海棠&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp时间：07月21日&nbsp&nbsp&nbsp21:00</p>
							<p>座位：</p>
							<ul id="selected-seats"></ul>
							<p>票数：<span id="counter">0</span></p>
							<p>总计：<b>￥<span id="total">0</span></b></p>
						</div>
						<button class="checkout-button center">确定购买</button>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
			<h4 class="panel-title">
				<a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">零食销售</a>
			</h4>
		</div>
		<div id="collapseTwo" class="panel-collapse collapse">
			<div class="panel-body">
				//这里要加零食的界面
			</div>
		</div>
	</div>
</div>

<!--这是页尾-->
<br>
<div class="footer">
	<div class="container">
		<div class="row">
			<div class="col-md-3">
				<h1>全真电影院</h1>
				<p>一个智障数据库项目，很全真</p>
			</div>
			<div class="col-md-3">
				<address>
					<strong>Tongji University,</strong><br>
					4800 Cao'an Highway, Jiading District,<br>
					Shanghai 201804<br>
				</address>
			</div>
			<div class="col-md-3">
				<address>
					<strong>项目地址</strong><br>
					<a href="https://github.com/QuanzhenCinema">https://github.com/QuanzhenCinema</a>
				</address>
			</div>
			<div class="col-md-3">
				<strong><a href="developer.html">开发人员</a> </strong>
			</div>
		</div>
	</div>
</div>

<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script src="http://libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://libs.useso.com/js/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.seat-charts.min.js"></script>

<script type="text/javascript">
var price = 80; //票价
$(document).ready(function() {
	var $cart = $('#selected-seats'), //座位区
	$counter = $('#counter'), //票数
	$total = $('#total'); //总计金额
	
	var sc = $('#seat-map').seatCharts({
		map: [  //座位图
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]a[,21]',
			'_________________________',
			'_________________________',
			'___a[,1]a[,2]a[,3]a[,4]a[,5]a[,6]a[,7]a[,8]a[,9]a[,10]a[,11]a[,12]a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]__',
			'aaaaaaaaaaaa__a[,13]a[,14]a[,15]a[,16]a[,17]a[,18]a[,19]a[,20]',
		],
		naming : {
			top : false,
			getLabel : function (character, row, column) {
				return column;
			}
		},
		legend : { //定义图例
			node : $('#legend'),
			items : [
				[ 'a', 'available',   '可选座' ],
				[ 'a', 'unavailable', '已售出']
			]					
		},
		click: function () { //点击事件
			if (this.status() == 'available') { //可选座
				$('<li>'+(this.settings.row+1)+'排'+this.settings.label+'座</li>')
					.attr('id', 'cart-item-'+this.settings.id)
					.data('seatId', this.settings.id)
					.appendTo($cart);

				$counter.text(sc.find('selected').length+1);
				$total.text(recalculateTotal(sc)+price);
							
				return 'selected';
			} else if (this.status() == 'selected') { //已选中
					//更新数量
					$counter.text(sc.find('selected').length-1);
					//更新总计
					$total.text(recalculateTotal(sc)-price);
						
					//删除已预订座位
					$('#cart-item-'+this.settings.id).remove();
					//可选座
					return 'available';
			} else if (this.status() == 'unavailable') { //已售出
				return 'unavailable';
			} else {
				return this.style();
			}
		}
	});
	//已售出的座位
	sc.get(['1_2', '4_4','4_5','6_6','6_7','8_5','8_6','8_7','8_8', '10_1', '10_2']).status('unavailable');
		
});
//计算总金额
function recalculateTotal(sc) {
	var total = 0;
	sc.find('selected').each(function () {
		total += price;
	});
			
	return total;
}
</script>

</body>
</html>