<!DOCTYPE html>
<html lang="zh-CN" xmlns="http://www.w3.org/1999/html">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
	<title>全真影院-购票选座</title>
	<!--设置网页图标-->
	<link rel="shortcut icon" href="images/logo.ico" type=”image/x-icon” />
	<!-- Bootstrap -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/header.css" rel="stylesheet">
	<link href="css/footer.css" rel="stylesheet">
	<link href="css/jquery.spinner.css" rel="stylesheet">
	<link href="css/snacks.css" rel="stylesheet">
	<link href="css/jquery.seat-charts.css" rel="stylesheet">

</head>

<body>
<!--这是页头-->
<div class="header">
	<div class="container">
		<a href="index.html">
			<span><img src="images/logo.png"> </span>
		</a>
	</div>
</div>

<div class="panel-group" id="accordion">
	<div class="panel panel-default">
		<div class="panel-heading">
			<h4 class="panel-title">
				<a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">电影购票</a>
			</h4>
		</div>
		<div id="collapseOne" class="panel-collapse collapse in">
			<div class="panel-body">
				<div id="main">
					<div class="demo">
						<div id="seat-map">
							<div class="front">屏幕</div>
						</div>
						<div class="booking-details">
							<p>影片：大鱼海棠&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp时间：07月21日&nbsp&nbsp&nbsp21:00</p>
							<p>座位：</p>
							<ul id="selected-seats"></ul>
							<p>票数：<span id="counter">0</span></p>
							<p>总计：<b>￥<span id="total">0</span></b></p>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div class="panel panel-default">
		<div class="panel-heading">
			<h4 class="panel-title">
				<a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">零食销售</a>
			</h4>
		</div>
		<div id="collapseTwo" class="panel-collapse collapse">
			<div class="panel-body">
				<table class="table table-bordered table-hover table-striped">
					<tr>
						<th>编号</th>
						<th>零食</th>
						<th>价格</th>
						<th>数量</th>
					</tr>
					<tr>
						<td>1</td>
						<td>爆米花(小)</td>
						<td>￥40</td>
						<td><input type="text" class="spinner"/></td>
					</tr>
					<tr>
						<td>2</td>
						<td>爆米花(中)</td>
						<td>￥50</td>
						<td><input type="text" class="spinner"/></td>
					</tr>
					<tr>
						<td>3</td>
						<td>爆米花(大)</td>
						<td>￥65</td>
						<td><input type="text" class="spinner"/></td>
					</tr>
					<tr>
						<td>4</td>
						<td>可乐</td>
						<td>￥15</td>
						<td><input type="text" class="spinner"/></td>
					</tr>
				</table>

			</div>
		</div>
	</div>
</div>

<ul class="list-inline">
	<li><h4>总价:</h4></li>
	<li><h1>80元</h1></li>
</ul>
<button class="checkout-button center">确定购买</button>

<!--这是页尾-->
<br>
<div class="footer">
	<div class="container">
		<div class="row">
			<div class="col-md-3">
				<h1>全真电影院</h1>
				<p>一个智障数据库项目，很全真</p>
			</div>
			<div class="col-md-3">
				<address>
					<strong>Tongji University,</strong><br>
					4800 Cao'an Highway, Jiading District,<br>
					Shanghai 201804<br>
				</address>
			</div>
			<div class="col-md-3">
				<address>
					<strong>项目地址</strong><br>
					<a href="https://github.com/QuanzhenCinema">https://github.com/QuanzhenCinema</a>
				</address>
			</div>
			<div class="col-md-3">
				<strong><a href="developer.html">开发人员</a> </strong>
			</div>
		</div>
	</div>
</div>

<script src="http://libs.baidu.com/jquery/2.0.0/jquery.min.js"></script>
<script src="http://libs.baidu.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://libs.useso.com/js/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="js/jquery.seat-charts.min.js"></script>
<script src="js/jquery.spinner.js"></script>
<script>
	$('.spinner').spinner();
</script>

<script type="text/javascript">
var price = 80; //票价
$(document).ready(function() {
	var $cart = $('#selected-seats'), //座位区
	$counter = $('#counter'), //票数
	$total = $('#total'); //总计金额
	
	var sc = $('#seat-map').seatCharts({
		map: [  //座位图
			'___a[1_1,1]a[1_2,2]a[1_3,3]a[1_4,4]a[1_5,5]a[1_6,6]a[1_7,7]a[1_8,8]a[1_9,9]a[1_10,10]a[1_11,11]a[1_12,12]a[1_13,13]a[1_14,14]a[1_15,15]a[1_16,16]a[1_17,17]a[1_18,18]a[1_19,19]a[1_20,20]a[1_21,21]',
			'___a[2_1,1]a[2_2,2]a[2_3,3]a[2_4,4]a[2_5,5]a[2_6,6]a[2_7,7]a[2_8,8]a[2_9,9]a[2_10,10]a[2_11,11]a[2_12,12]a[2_13,13]a[2_14,14]a[2_15,15]a[2_16,16]a[2_17,17]a[2_18,18]a[2_19,19]a[2_20,20]a[2_21,21]',
			'___a[3_1,1]a[3_2,2]a[3_3,3]a[3_4,4]a[3_5,5]a[3_6,6]a[3_7,7]a[3_8,8]a[3_9,9]a[3_10,10]a[3_11,11]a[3_12,12]a[3_13,13]a[3_14,14]a[3_15,15]a[3_16,16]a[3_17,17]a[3_18,18]a[3_19,19]a[3_20,20]a[3_21,21]',
			'___a[4_1,1]a[4_2,2]a[4_3,3]a[4_4,4]a[4_5,5]a[4_6,6]a[4_7,7]a[4_8,8]a[4_9,9]a[4_10,10]a[4_11,11]a[4_12,12]a[4_13,13]a[4_14,14]a[4_15,15]a[4_16,16]a[4_17,17]a[4_18,18]a[4_19,19]a[4_20,20]a[4_21,21]',
			'___a[5_1,1]a[5_2,2]a[5_3,3]a[5_4,4]a[5_5,5]a[5_6,6]a[5_7,7]a[5_8,8]a[5_9,9]a[5_10,10]a[5_11,11]a[5_12,12]a[5_13,13]a[5_14,14]a[5_15,15]a[5_16,16]a[5_17,17]a[5_18,18]a[5_19,19]a[5_20,20]a[5_21,21]',
			'___a[6_1,1]a[6_2,2]a[6_3,3]a[6_4,4]a[6_5,5]a[6_6,6]a[6_7,7]a[6_8,8]a[6_9,9]a[6_10,10]a[6_11,11]a[6_12,12]a[6_13,13]a[6_14,14]a[6_15,15]a[6_16,16]a[6_17,17]a[6_18,18]a[6_19,19]a[6_20,20]a[6_21,21]',
			'___a[7_1,1]a[7_2,2]a[7_3,3]a[7_4,4]a[7_5,5]a[7_6,6]a[7_7,7]a[7_8,8]a[7_9,9]a[7_10,10]a[7_11,11]a[7_12,12]a[7_13,13]a[7_14,14]a[7_15,15]a[7_16,16]a[7_17,17]a[7_18,18]a[7_19,19]a[7_20,20]a[7_21,21]',
			'___a[8_1,1]a[8_2,2]a[8_3,3]a[8_4,4]a[8_5,5]a[8_6,6]a[8_7,7]a[8_8,8]a[8_9,9]a[8_10,10]a[8_11,11]a[8_12,12]a[8_13,13]a[8_14,14]a[8_15,15]a[8_16,16]a[8_17,17]a[8_18,18]a[8_19,19]a[8_20,20]a[8_21,21]',
			'___a[9_1,1]a[9_2,2]a[9_3,3]a[9_4,4]a[9_5,5]a[9_6,6]a[9_7,7]a[9_8,8]a[9_9,9]a[9_10,10]a[9_11,11]a[9_12,12]a[9_13,13]a[9_14,14]a[9_15,15]a[9_16,16]a[9_17,17]a[9_18,18]a[9_19,19]a[9_20,20]a[9_21,21]',
			'___a[10_1,1]a[10_2,2]a[10_3,3]a[10_4,4]a[10_5,5]a[10_6,6]a[10_7,7]a[10_8,8]a[10_9,9]a[10_10,10]a[10_11,11]a[10_12,12]a[10_13,13]a[10_14,14]a[10_15,15]a[10_16,16]a[10_17,17]a[10_18,18]a[10_19,19]a[10_20,20]a[10_21,21]',
			'________________________',
			'________________________',
			'___a[11_1,1]a[11_2,2]a[11_3,3]a[11_4,4]a[11_5,5]a[11_6,6]a[11_7,7]a[11_8,8]a[11_9,9]a[11_10,10]a[11_11,11]a[11_12,12]a[11_13,13]a[11_14,14]a[11_15,15]a[11_16,16]a[11_17,17]a[11_18,18]a[11_19,19]__',
			'a[12_1,1]a[12_2,2]a[12_3,3]a[12_4,4]a[12_5,5]a[12_6,6]a[12_7,7]a[12_8,8]a[12_9,9]a[12_10,10]a[12_11,11]a[12_12,12]__a[12_13,13]a[12_14,14]a[12_15,15]a[12_16,16]a[12_17,17]a[12_18,18]a[12_19,19]a[12_20,20]__',

		],
		naming : {
			top : false,
			rows: ['1', '2', '3', '4', '5','6','7','8','9','10','','','11','12']
//			getLabel : function (character, row, column) {
//				return column;
//			}
		},
		legend : { //定义图例
			node : $('#legend'),
			items : [
				[ 'a', 'available',   '可选座' ],
				[ 'a', 'unavailable', '已售出']
			]					
		},
		click: function () { //点击事件
			if (this.status() == 'available') { //可选座
				$('<li>'+this.settings.id+'座</li>')
					.attr('id', 'cart-item-'+this.settings.id)
					.data('seatId', this.settings.id)
					.appendTo($cart);

				$counter.text(sc.find('selected').length+1);
				$total.text(recalculateTotal(sc)+price);
							
				return 'selected';
			} else if (this.status() == 'selected') { //已选中
					//更新数量
					$counter.text(sc.find('selected').length-1);
					//更新总计
					$total.text(recalculateTotal(sc)-price);
						
					//删除已预订座位
					$('#cart-item-'+this.settings.id).remove();
					//可选座
					return 'available';
			} else if (this.status() == 'unavailable') { //已售出
				return 'unavailable';
			} else {
				return this.style();
			}
		}
	});
	//已售出的座位
	sc.get(['1_2', '4_4','4_5','6_6','6_7','8_5','8_6','8_7','8_8', '10_1', '10_2']).status('unavailable');
		
});
//计算总金额
function recalculateTotal(sc) {
	var total = 0;
	sc.find('selected').each(function () {
		total += price;
	});
			
	return total;
}
</script>

</body>
</html>